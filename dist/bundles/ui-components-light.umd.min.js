!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/forms"),require("@angular/core"),require("rxjs/Subject"),require("rxjs/symbol/observable"),require("rxjs/Subscription")):"function"==typeof define&&define.amd?define(["exports","@angular/common","@angular/forms","@angular/core","rxjs/Subject","rxjs/symbol/observable","rxjs/Subscription"],t):t(e["ui-components-light"]={},e.ng.common,e.ng.forms,e.ng.core,e.Rx,e.Rx.Symbol,e.Rx)}(this,function(e,t,n,i,r,o,s){"use strict";var a,c=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(){function e(){}return Object.defineProperty(e,"NAV_LEVEL_1",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_LEVEL_2",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLOSE_ALL",{get:function(){return"NAV_CLOSE_ALL"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_OPEN",{get:function(){return"NAV_OPEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLOSE",{get:function(){return"NAV_CLOSE"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_TOGGLE",{get:function(){return"NAV_TOGGLE"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_HAMBURGER_MENU",{get:function(){return"open-hamburger-menu"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_OVERFLOW_MENU",{get:function(){return"open-overflow-menu"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_TRIGGER_1",{get:function(){return"header-hamburger-trigger"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_TRIGGER_2",{get:function(){return"header-overflow-trigger"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_LEVEL_1",{get:function(){return"clr-nav-level-1"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NAV_CLASS_LEVEL_2",{get:function(){return"clr-nav-level-2"},enumerable:!0,configurable:!0}),e}(),u=function(){function e(e,t){this._controlCode=e,this._navLevel=t}return Object.defineProperty(e.prototype,"controlCode",{get:function(){return this._controlCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navLevel",{get:function(){return this._navLevel},enumerable:!0,configurable:!0}),e}(),h=function(){function e(){this.responsiveNavList=[],this.registerNavSubject=new r.Subject,this.controlNavSubject=new r.Subject,this.closeAllNavs()}return Object.defineProperty(e.prototype,"registeredNavs",{get:function(){return this.registerNavSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navControl",{get:function(){return this.controlNavSubject.asObservable()},enumerable:!0,configurable:!0}),e.prototype.registerNav=function(e){e&&!this.isNavRegistered(e)&&(this.responsiveNavList.push(e),this.registerNavSubject.next(this.responsiveNavList))},e.prototype.isNavRegistered=function(e){return-1<this.responsiveNavList.indexOf(e)&&(console.error("Multiple clr-nav-level "+e+" attributes found. Please make sure that only one exists"),!0)},e.prototype.unregisterNav=function(e){var t=this.responsiveNavList.indexOf(e);-1<t&&(this.responsiveNavList.splice(t,1),this.registerNavSubject.next(this.responsiveNavList))},e.prototype.sendControlMessage=function(e,t){var n=new u(e,t);this.controlNavSubject.next(n)},e.prototype.closeAllNavs=function(){var e=new u(l.NAV_CLOSE_ALL,-999);this.controlNavSubject.next(e)},e}();h.decorators=[{type:i.Injectable}],h.ctorParameters=function(){return[]};var p=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[h]}},e.forChild=function(){return{ngModule:e,providers:[]}},e}();function d(e){return e instanceof Array}function f(e){return e instanceof Date&&!isNaN(e.valueOf())}function g(e){return null!=e&&"object"==typeof e&&!f(e)&&!d(e)}function _(e){return"function"==typeof e}function m(e,t){if(!e)throw new Error("** Assertion failed in Wijmo: "+t)}function b(e){return"number"==typeof e}function y(e,t){return void 0===t&&(t=!0),m(t&&null==e||_(e),"Function expected."),e}function v(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),m(t&&null==e||b(e),"Number expected."),n&&e&&e<0)throw new Error("Positive number expected.");return e}function w(e,t){return void 0===t&&(t=!0),m(t&&null==e||d(e),"Array expected."),e}function C(e){return"boolean"==typeof e}function x(e,t){return void 0===t&&(t=!1),m(t&&null==e||C(e),"Boolean expected."),e}p.decorators=[{type:i.NgModule,args:[{imports:[t.CommonModule,n.FormsModule],declarations:[],exports:[]}]}],p.ctorParameters=function(){return[]};var I=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._path},set:function(e){this._path=e,this._parts=e.split(".");for(var t=0;t<this._parts.length;t++){var n=this._parts[t],i=n.indexOf("[");-1<i&&(this._parts[t]=n.substr(0,i),this._parts.splice(++t,0,parseInt(n.substr(i+1))))}this._key=1==this._parts.length?this._parts[0]:null},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(e){if(this._key)return e[this._key];if(this._path in e)return e[this._path];for(var t=0;t<this._parts.length&&e;t++)e=e[this._parts[t]]}return e},e.prototype.setValue=function(e,t){if(e){if(this._path in e)return void(e[this._path]=t);for(var n=0;n<this._parts.length-1;n++)if(null==(e=e[this._parts[n]]))return;e[this._parts[this._parts.length-1]]=t}},e}(),D={};function P(e,t){return null==e?null:U(t)?_(e.implementsInterface)&&e.implementsInterface(t)?e:null:e instanceof t?e:null}function E(e){return e&&e.items&&e.items.length}function F(e,t,n){if(void 0===n&&(n=t),e=q(e,HTMLInputElement),W(document.body,e)&&!e.disabled&&"none"!=e.style.display)try{e.setSelectionRange(v(t),v(n)),e.focus()}catch(i){}}D.None=0,D.Sum=1,D.Cnt=2,D.Avg=3,D.Max=4,D.Min=5,D.Rng=6,D.Std=7,D.Var=8,D.StdPop=9,D.VarPop=10,D[D.None]="None",D[D.Sum]="Sum",D[D.Cnt]="Cnt",D[D.Avg]="Avg",D[D.Max]="Max",D[D.Min]="Min",D[D.Rng]="Rng",D[D.Std]="Std",D[D.Var]="Var",D[D.StdPop]="StdPop",D[D.VarPop]="VarPop";var O=function(e,t){this.handler=e,this.self=t},M=function(){};M.empty=new M;var S=function(){function e(){this._handlers=[]}return e.prototype.addHandler=function(e,t){y(e),this._handlers.push(new O(e,t))},e.prototype.removeHandler=function(e,t){y(e);for(var n=0;n<this._handlers.length;n++){var i=this._handlers[n];if((i.handler==e||null==e)&&(i.self==t||null==t)&&(this._handlers.splice(n,1),e&&t))break}},e.prototype.removeAllHandlers=function(){this._handlers.length=0},e.prototype.raise=function(e,t){void 0===t&&(t=M.empty);for(var n=0;n<this._handlers.length;n++){var i=this._handlers[n];i.handler.call(i.self,e,t)}},Object.defineProperty(e.prototype,"hasHandlers",{get:function(){return 0<this._handlers.length},enumerable:!0,configurable:!0}),e}(),j=function(t){function e(){var e=t.apply(this,arguments)||this;return e.cancel=!1,e}return c(e,t),e}(M),T=function(){function e(){this.length=0,Array.apply(this,arguments)}return e.prototype.pop=function(){return null},e.prototype.push=function(e){return 0},e.prototype.splice=function(e,t,n){return null},e.prototype.slice=function(e,t){return null},e.prototype.indexOf=function(e,t){return-1},e.prototype.sort=function(e){return null},e.prototype.reverse=function(){return null},e}();T.prototype=Array.prototype;var A={Add:0,Remove:1,Change:2,Reset:3,Splice:4};A[A.Add]="Add",A[A.Remove]="Remove",A[A.Change]="Change",A[A.Reset]="Reset",A[A.Splice]="Splice";var k=function(o){function e(e,t,n,i){void 0===t&&(t=-1),void 0===n&&(n=[]),void 0===i&&(i=[]);var r=o.call(this)||this;return r.action=e,r.index=t,r.removed=n,r.added=i,r}return c(e,o),e}(M);k.reset=new k(A.Reset);var L=function(o){function e(e){var t=o.call(this)||this;return t.collectionChanged=new i.EventEmitter(!0),e&&(e=w(e),t.splice.apply(t,[0,0].concat(e))),t}return c(e,o),e.prototype.push=function(e){var t=o.prototype.push.call(this,e);return this.onCollectionChanged(new k(A.Add,t-1,[],[e])),t},e.prototype.pop=function(){var e=o.prototype.pop.call(this);return this.onCollectionChanged(new k(A.Remove,this.length,[e])),e},e.prototype.splice=function(e,t){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return t&&0<i.length?(n=o.prototype.splice.call(this,e,t,i),t==i.length&&this.onCollectionChanged(new k(A.Change,e,n,i)),this.onCollectionChanged(new k(A.Splice,e,n,i))):0<i.length?(n=o.prototype.splice.call(this,e,t,i),this.onCollectionChanged(new k(A.Add,e,[],i))):(n=o.prototype.splice.call(this,e,t),this.onCollectionChanged(new k(A.Remove,e,n,[]))),n},e.prototype.slice=function(e,t){return o.prototype.slice.call(this,e,t)},e.prototype.indexOf=function(e,t){return o.prototype.indexOf.call(this,e,t)},e.prototype.sort=function(e){var t=o.prototype.sort.call(this,e);return this.onCollectionChanged(),t},e.prototype.reverse=function(){var e=o.prototype.reverse.call(this);return this.onCollectionChanged(),e},e.prototype.insert=function(e,t){this.splice(e,0,t)},e.prototype.remove=function(e){var t=this.indexOf(e);return-1<t&&(this.removeAt(t),!0)},e.prototype.removeAt=function(e){this.splice(e,1)},e.prototype.setAt=function(e,t){this.splice(e,1,t)},e.prototype.clear=function(){0!==this.length&&(this.length=0,this.onCollectionChanged())},e.prototype.onCollectionChanged=function(e){void 0===e&&(e=k.reset),this.collectionChanged.emit(e)},e}(T),N=function(){function e(){}return e.prototype.groupNameFromItem=function(e,t){return""},e.prototype.namesMatch=function(e,t){return e===t},e}(),V=function(n){function e(e){var t=n.call(this)||this;return t.newPageIndex=e,t}return c(e,n),e}(j),H=function(){function e(e,t){this._bnd=new re(e),this._asc=t}return Object.defineProperty(e.prototype,"property",{get:function(){return this._bnd.path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ascending",{get:function(){return this._asc},enumerable:!0,configurable:!0}),e}(),R=function(){function e(e,t,n,i){this._gd=e,this._name=t,this._level=n,this._isBottomLevel=i,this._groups=[],this._items=[]}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBottomLevel",{get:function(){return this._isBottomLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupDescription",{get:function(){return this._gd},enumerable:!0,configurable:!0}),e.prototype.getAggregate=function(e,t,n){var i=P(n,G);return function(e,t,n){for(var i=0,r=0,o=0,s=0,a=null,c=null,l=n?new I(n):null,u=0;u<t.length;u++){var h=t[u];l&&(h=l.getValue(h)),null!=h&&(i++,(null==a||h<a)&&(a=h),(null==c||c<h)&&(c=h),b(h)&&!isNaN(h)?(r++,o+=h,s+=h*h):C(h)&&(r++,1==h&&(o++,s++)))}var p=0==r?0:o/r;switch(e){case D.Avg:return p;case D.Cnt:return i;case D.Max:return c;case D.Min:return a;case D.Rng:return c-a;case D.Sum:return o;case D.VarPop:return r<=1?0:s/r-p*p;case D.StdPop:return r<=1?0:Math.sqrt(s/r-p*p);case D.Var:return r<=1?0:(s/r-p*p)*r/(r-1);case D.Std:return r<=1?0:Math.sqrt((s/r-p*p)*r/(r-1))}throw"Invalid aggregate type."}(e,(i?i._getFullGroup(this):this).items,t)},e}(),G=function(){function e(e){var n=this;this._idx=-1,this._srtDsc=new L,this._grpDesc=new L,this._newItem=null,this._edtItem=null,this._pgSz=0,this._pgIdx=0,this._updating=0,this._canFilter=!0,this._canGroup=!0,this._canSort=!0,this._canAddNew=!0,this._canCancelEdit=!0,this._canRemove=!0,this._canChangePage=!0,this._trackChanges=!1,this._chgAdded=new L,this._chgRemoved=new L,this._chgEdited=new L,this.collectionChanged=new i.EventEmitter,this.currentChanged=new i.EventEmitter,this.currentChanging=new i.EventEmitter,this.pageChanged=new S,this.pageChanging=new S,this._srtDsc.collectionChanged.subscribe(function(){for(var e=n._srtDsc,t=0;t<e.length;t++)m(e[t]instanceof H,"sortDescriptions array must contain SortDescription objects.");n.canSort&&n.refresh()}),this._grpDesc.collectionChanged.subscribe(function(){for(var e=n._grpDesc,t=0;t<e.length;t++)m(e[t]instanceof N,"groupDescriptions array must contain GroupDescription objects.");n.canGroup&&n.refresh()}),this.sourceCollection=e||new L}return Object.defineProperty(e.prototype,"newItemCreator",{get:function(){return this._itemCreator},set:function(e){this._itemCreator=y(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortConverter",{get:function(){return this._srtCvt},set:function(e){e!=this._srtCvt&&(this._srtCvt=y(e,!0))},enumerable:!0,configurable:!0}),e.prototype.implementsInterface=function(e){switch(e){case"ICollectionView":case"IEditableCollectionView":case"IPagedCollectionView":case"INotifyCollectionChanged":return!0}return!1},Object.defineProperty(e.prototype,"trackChanges",{get:function(){return this._trackChanges},set:function(e){this._trackChanges=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsAdded",{get:function(){return this._chgAdded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsRemoved",{get:function(){return this._chgRemoved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsEdited",{get:function(){return this._chgEdited},enumerable:!0,configurable:!0}),e.prototype.clearChanges=function(){this._chgAdded.clear(),this._chgRemoved.clear(),this._chgEdited.clear()},e.prototype.onCollectionChanged=function(e){void 0===e&&(e=k.reset),this.collectionChanged.emit(e)},e.prototype._raiseCollectionChanged=function(e,t,n){void 0===e&&(e=A.Reset);var i=new k(e,t,[],[]);this.onCollectionChanged(i)},Object.defineProperty(e.prototype,"canFilter",{get:function(){return this._canFilter},set:function(e){this._canFilter=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canGroup",{get:function(){return this._canGroup},set:function(e){this._canGroup=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canSort",{get:function(){return this._canSort},set:function(e){this._canSort=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentItem",{get:function(){return this._pgView&&-1<this._idx&&this._idx<this._pgView.length?this._pgView[this._idx]:null},set:function(e){this.moveCurrentTo(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPosition",{get:function(){return this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filter",{get:function(){return this._filter},set:function(e){this._filter!=e&&(this._filter=y(e),this.canFilter&&this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupDescriptions",{get:function(){return this._grpDesc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groups",{get:function(){return this._groups=this.canGroup?this._createGroups(this._view):null,this._groups},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this._pgView.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortDescriptions",{get:function(){return this._srtDsc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceCollection",{get:function(){return this._src},set:function(e){if(e!=this._src){var t=this.currentPosition;this.commitEdit(),this.commitNew(),this._src=w(e,!1),this._ncc=P(this._src,"INotifyCollectionChanged"),this._ncc&&this._ncc.collectionChanged.subscribe(this._sourceChanged.bind(this)),this.clearChanges(),this.refresh(),console.log("collection_view_move_current_first"),this.moveCurrentToFirst(),this.currentPosition<0&&-1<t&&this.onCurrentChanged()}},enumerable:!0,configurable:!0}),e.prototype._sourceChanged=function(e,t){this._updating<=0&&this.refresh()},e.prototype.contains=function(e){return-1<this._pgView.indexOf(e)},e.prototype.moveCurrentTo=function(e){return this.moveCurrentToPosition(this._pgView.indexOf(e))},e.prototype.moveCurrentToFirst=function(){return this.moveCurrentToPosition(0)},e.prototype.moveCurrentToLast=function(){return this.moveCurrentToPosition(this._pgView.length-1)},e.prototype.moveCurrentToNext=function(){return this.moveCurrentToPosition(this._idx+1)},e.prototype.moveCurrentToPosition=function(e){if(-1<=e&&e<this._pgView.length){var t=new j;this._idx!=e&&this.onCurrentChanging(t)&&(this._edtItem&&this._pgView[e]!=this._edtItem&&this.commitEdit(),this._newItem&&this._pgView[e]!=this._newItem&&this.commitNew(),this._idx=e,this.onCurrentChanged())}return this._idx==e},e.prototype.moveCurrentToPrevious=function(){return this.moveCurrentToPosition(this._idx-1)},e.prototype.refresh=function(){0<this._updating||this._newItem||this._edtItem||(this._performRefresh(),this.onCollectionChanged())},e.prototype._performRefresh=function(){var e=this.currentItem;this._src?this._filter&&this.canFilter?this._view=this._performFilter(this._src):this._view=0<this._srtDsc.length&&this.canSort?this._src.slice(0):this._src:this._view=[],0<this._srtDsc.length&&this.canSort&&this._performSort(this._view),this._groups=this.canGroup?this._createGroups(this._view):null,this._fullGroups=this._groups,this._groups&&(this._view=this._mergeGroupItems(this._groups)),this._pgIdx=X(this._pgIdx,0,this.pageCount-1),this._pgView=this._getPageView(),this._groups&&1<this.pageCount&&(this._groups=this._createGroups(this._pgView),this._mergeGroupItems(this._groups));var t=this._pgView.indexOf(e);t<0&&(t=Math.min(this._idx,this._pgView.length-1)),this._idx=t,this._digest=this._getGroupsDigest(this.groups),this.currentItem!==e&&this.onCurrentChanged()},e.prototype._performSort=function(e){this._view.sort(this._compareItems())},e.prototype._compareItems=function(){var l=this._srtDsc,u=this._srtCvt,h=!0;return function(e,t){for(var n=0;n<l.length;n++){var i=l[n],r=i._bnd.getValue(e),o=i._bnd.getValue(t);if(r!=r&&(r=null),o!=o&&(o=null),"string"==typeof r&&"string"==typeof o){var s=r.toLowerCase(),a=o.toLowerCase();s!=a&&(r=s,o=a)}if(u&&(r=u(i,e,r,h),o=u(i,t,o,!1),h=!1),null!=r&&null==o)return-1;if(null==r&&null!=o)return 1;var c=r<o?-1:o<r?1:0;if(0!=c)return i.ascending?+c:-c}return 0}},e.prototype._performFilter=function(e){return this.canFilter&&this._filter?e.filter(this._filter,this):e},e.prototype.onCurrentChanged=function(e){void 0===e&&(e=M.empty),this.currentChanged.emit(e)},e.prototype.onCurrentChanging=function(e){return this.currentChanging.emit(e),!e.cancel},Object.defineProperty(e.prototype,"items",{get:function(){return this._pgView},enumerable:!0,configurable:!0}),e.prototype.beginUpdate=function(){this._updating++},e.prototype.endUpdate=function(){this._updating--,this._updating<=0&&this.refresh()},Object.defineProperty(e.prototype,"isUpdating",{get:function(){return 0<this._updating},enumerable:!0,configurable:!0}),e.prototype.deferUpdate=function(e){try{this.beginUpdate(),e()}finally{this.endUpdate()}},Object.defineProperty(e.prototype,"canAddNew",{get:function(){return this._canAddNew},set:function(e){this._canAddNew=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canCancelEdit",{get:function(){return this._canCancelEdit},set:function(e){this._canCancelEdit=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canRemove",{get:function(){return this._canRemove},set:function(e){this._canRemove=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentAddItem",{get:function(){return this._newItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentEditItem",{get:function(){return this._edtItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAddingNew",{get:function(){return null!=this._newItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditingItem",{get:function(){return null!=this._edtItem},enumerable:!0,configurable:!0}),e.prototype.addNew=function(){if(0<arguments.length&&m(!1,"addNew does not take any parameters, it creates the new items."),this.commitEdit(),this.commitNew(),!this.canAddNew)return m(!1,"cannot add items (canAddNew == false)."),null;var e=null;if(null!=(e=this.newItemCreator?this.newItemCreator():this.sourceCollection&&this.sourceCollection.length?this.sourceCollection[0].constructor():{})){if(this._newItem=e,this._updating++,this._src.push(e),this._updating--,this._pgView!=this._src&&this._pgView.push(e),this.groups&&this.groups.length){var t=this.groups[this.groups.length-1];for(t.items.push(e);t.groups&&t.groups.length;)(t=t.groups[t.groups.length-1]).items.push(e)}this._raiseCollectionChanged(A.Add,e,this._pgView.length-1),this.moveCurrentTo(e)}return this._newItem},e.prototype.cancelEdit=function(){var e=this._edtItem;if(null!=e){if(this._edtItem=null,!this.canCancelEdit)return void m(!1,"cannot cancel edits (canCancelEdit == false).");var t=this._src.indexOf(e);if(t<0||!this._edtClone)return;this._extend(this._src[t],this._edtClone),this._edtClone=null,this._raiseCollectionChanged(A.Change,e,t)}},e.prototype.cancelNew=function(){var e=this._newItem;null!=e&&this.remove(e)},e.prototype.commitEdit=function(){console.log("collection_view_commit_edit_start");var e=this._edtItem;if(null!=e){var t=this._sameContent(e,this._edtClone);this._edtItem=null,this._edtClone=null;var n=this._pgView.indexOf(e),i=this._digest;this._performRefresh(),1!=this._trackChanges||t||this._trackItemChanged(e),this._pgView.indexOf(e)==n&&i==this._digest?this._raiseCollectionChanged(A.Change,e,n):this._raiseCollectionChanged()}console.log("collection_view_commit_edit_finish")},e.prototype._trackItemChanged=function(e){if(this._trackChanges){var t=this._chgEdited.indexOf(e);if(t<0&&this._chgAdded.indexOf(e)<0)this._chgEdited.push(e);else if(-1<t){var n=new k(A.Change,e,[],[]);this._chgEdited.onCollectionChanged(n)}else if(-1<(t=this._chgAdded.indexOf(e))){n=new k(A.Change,e,[],[]);this._chgAdded.onCollectionChanged(n)}}},e.prototype.commitNew=function(){var e=this._newItem;if(null!=e){this._newItem=null;var t=this._pgView.indexOf(e),n=this._digest;if(this._performRefresh(),1==this._trackChanges){var i=this._chgEdited.indexOf(e);-1<i&&this._chgEdited.removeAt(i),this._chgAdded.indexOf(e)<0&&this._chgAdded.push(e)}this._pgView.indexOf(e)==t&&n==this._digest?this._raiseCollectionChanged(A.Change,e,t):this._raiseCollectionChanged()}},e.prototype.editItem=function(e){e!=this._edtItem&&this.moveCurrentTo(e)&&(this.commitEdit(),this._edtItem=e,this._edtClone={},this._extend(this._edtClone,this._edtItem))},e.prototype.remove=function(e){console.log("collection_view_remove_start"),console.log("collection_view_src:"+this._src.length),console.log("collection_view_pgView:"+this._pgView.length),console.log("collection_view_view:"+this._view.length);var t=e==this._newItem;if(t&&(this._newItem=null),e==this._edtItem&&this.cancelEdit(),this.canRemove){var n=this._src.indexOf(e);if(-1<n){var i=this.currentItem;this._updating++,this._src.splice(n,1),this._updating--;var r=this._digest;if(this._performRefresh(),1==this._trackChanges){var o=this._chgAdded.indexOf(e);-1<o&&this._chgAdded.removeAt(o);var s=this._chgEdited.indexOf(e);-1<s&&this._chgEdited.removeAt(s),this._chgRemoved.indexOf(e)<0&&!t&&o<0&&this._chgRemoved.push(e)}0<this.pageSize&&-1<this._pgIdx||r!=this._getGroupsDigest(this.groups)?(console.log("collection_view_before_raiseCollectionChanged_1"),this._raiseCollectionChanged()):(console.log("collection_view_before_raiseCollectionChanged_2"),this._raiseCollectionChanged(A.Remove,e,n)),this.currentItem!==i&&(console.log("collection_view_before_on_current_changed_3"),this.onCurrentChanged())}console.log("collection_view_pgView:"+this._pgView.length),console.log("collection_view_view:"+this._view.length),console.log("collection_view_src:"+this._src.length),console.log("collection_view_remove_finish")}else m(!1,"cannot remove items (canRemove == false).")},e.prototype.removeAt=function(e){e=z(e),this.remove(this._pgView[e])},e.prototype._extend=function(e,t){for(var n in t)e[n]=t[n]},e.prototype._sameContent=function(e,t){for(var n in t)if(!this._sameValue(e[n],t[n]))return!1;for(var n in e)if(!this._sameValue(e[n],t[n]))return!1;return!0},e.prototype._sameValue=function(e,t){return e==t||te.equals(e,t)},Object.defineProperty(e.prototype,"canChangePage",{get:function(){return this._canChangePage},set:function(e){this._canChangePage=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPageChanging",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._pgView.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageIndex",{get:function(){return this._pgIdx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._pgSz},set:function(e){e!=this._pgSz&&(this._pgSz=z(e),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalItemCount",{get:function(){return this._view.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this.pageSize?Math.ceil(this.totalItemCount/this.pageSize):1},enumerable:!0,configurable:!0}),e.prototype.moveToFirstPage=function(){return this.moveToPage(0)},e.prototype.moveToLastPage=function(){return this.moveToPage(this.pageCount-1)},e.prototype.moveToNextPage=function(){return this.moveToPage(this.pageIndex+1)},e.prototype.moveToPage=function(e){var t=X(e,0,this.pageCount-1);if(t!=this._pgIdx){this.canChangePage||m(!1,"cannot change pages (canChangePage == false).");var n=new V(t);this.onPageChanging(n)&&(this._pgIdx=t,this._pgView=this._getPageView(),this._idx=0,this.groupDescriptions&&0!=this.groupDescriptions.length?this.refresh():(this.onPageChanged(),this.onCollectionChanged()))}return this._pgIdx==e},e.prototype.moveToPreviousPage=function(){return this.moveToPage(this.pageIndex-1)},e.prototype.onPageChanged=function(e){void 0===e&&(e=M.empty),this.pageChanged.raise(this,e)},e.prototype.onPageChanging=function(e){return this.pageChanging.raise(this,e),!e.cancel},e.prototype._getFullGroup=function(e){var t=this._getGroupByPath(this._fullGroups,e.level,e._path);return null!=t&&(e=t),e},e.prototype._getGroupByPath=function(e,t,n){for(var i=0;i<e.length;i++){var r=e[i];if(r.level==t&&r._path==n)return r;if(r.level<t&&0==r._path.indexOf(n)&&null!=(r=this._getGroupByPath(r.items,t,n)))return r}return null},e.prototype._getPageView=function(){if(this.pageSize<=0||this._pgIdx<0)return this._view;var e=this._pgSz*this._pgIdx,t=Math.min(e+this._pgSz,this._view.length);return this._view.slice(e,t)},e.prototype._createGroups=function(e){if(!this._grpDesc||!this._grpDesc.length)return null;for(var t=[],n={},i=null,r=0;r<e.length;r++)for(var o=e[r],s=t,a=this._grpDesc.length,c="",l=0;l<a;l++){var u=this._grpDesc[l],h=u.groupNameFromItem(o,l),p=l==a-1;!(i=n[c])&&Q(h)&&(i={},n[c]=i);var d=this._getGroup(u,s,i,h,l,p);c+="/"+h,d._path=c,p&&d.items.push(o),s=d.groups}return t},e.prototype._getGroupsDigest=function(e){for(var t="",n=0;null!=e&&n<e.length;n++){var i=e[n];t+="{"+i.name+":"+(i.items?i.items.length:"*"),0<i.groups.length&&(t+=",",t+=this._getGroupsDigest(i.groups)),t+="}"}return t},e.prototype._mergeGroupItems=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];if(!i._isBottomLevel){var r=this._mergeGroupItems(i.groups);i._items.push.apply(i._items,r)}t.push.apply(t,i._items)}return t},e.prototype._getGroup=function(e,t,n,i,r,o){var s;if(n&&Q(i)){if(s=n[i])return s}else for(var a=0;a<t.length;a++)if(e.namesMatch(t[a].name,i))return t[a];var c=new R(e,i,r,o);return t.push(c),n&&(n[i]=c),c},e.prototype.completeAllStream=function(){this.currentChanged.complete(),this.collectionChanged.complete()},e.prototype[o.$$observable]=function(){return this},e.prototype._subscribe=function(e){e.next(this.items),e.complete()},e}();function z(e,t,n){var i;if(void 0===t&&(t=!1),void 0===n&&(n=!1),m(t&&null==e||b(i=e)&&i==Math.round(i),"Integer expected."),n&&e&&e<0)throw"Positive integer expected.";return e}function U(e){return"string"==typeof e}function B(e,t){return void 0===t&&(t=!0),m(t&&null==e||U(e),"String expected."),e}function q(e,t,n){var i,r;return void 0===n&&(n=!1),r=t,e=null==(i=e)?null:U(r)?_(i.implementsInterface)&&i.implementsInterface(r)?i:null:i instanceof r?i:null,m(n||null!=e,t+" expected."),e}function Y(e,t){if(e&&e.getAttribute){var n=new RegExp("\\b"+t+"\\b");return e&&n.test(e.getAttribute("class"))}return!1}function K(e,t){if(e&&e.setAttribute&&!Y(e,t)){var n=e.getAttribute("class");e.setAttribute("class",n?n+" "+t:t)}}function W(e,t){for(var n=t;n;n=n.parentNode)if(n===e)return!0;return!1}function $(e,t,n){n?K(e,t):function(e,t){if(e&&e.setAttribute&&Y(e,t)){var n=new RegExp("\\s?\\b"+t+"\\b","g"),i=e.getAttribute("class");e.setAttribute("class",i.replace(n,""))}}(e,t)}function J(e){return e instanceof HTMLElement?e:U(e)?document.querySelector(e):e&&e.jquery?e[0]:null}function Q(e){return U(e)||b(e)||C(e)||f(e)}function X(e,t,n){return null!=e&&(null!=n&&n<e&&(e=n),null!=t&&e<t&&(e=t)),e}var Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ee={Globalize:{numberFormat:{NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencySymbol:"$",".":".",",":",",percent:{pattern:["-n %","n %"]},currency:{decimals:2,symbol:"$",pattern:["($n)","$n"]}},dateTimeFormat:{TimeSeparator:"/",DateSeparator:":","/":"/",":":":"},calendar:{"/":"/",":":":",firstDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],am:["AM","A"],pm:["PM","P"],eras:["A.D.","B.C."],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",t:"h:mm tt",T:"h:mm:ss tt",M:"MMMM d",m:"MMMM d",Y:"MMMM, yyyy",y:"MMMM, yyyy",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",s:'yyyy"-"MM"-"dd"T"HH":"mm":"ss',o:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',O:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',U:"dddd, MMMM dd, yyyy h:mm:ss tt"},fiscalYearOffsets:[-3,-3]}},MultiSelect:{itemsSelected:"{count:n0} items selected"},FlexGrid:{groupHeaderFormat:"{name}: <b>{value} </b>({count:n0} items)"},FlexGridFilter:{ascending:"↑ Ascending",descending:"↓ Descending",apply:"Apply",clear:"Clear",conditions:"Filter by Condition",values:"Filter by Value",search:"Search",selectAll:"Select All","null":"(nothing)",header:"Show items where the value",and:"And",or:"Or",stringOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1},{name:"Begins with",op:6},{name:"Ends with",op:7},{name:"Contains",op:8},{name:"Does not contain",op:9}],numberOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1},{name:"Is Greater than",op:2},{name:"Is Greater than or equal to",op:3},{name:"Is Less than",op:4},{name:"Is Less than or equal to",op:5}],dateOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Is Before",op:4},{name:"Is After",op:3}],booleanOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1}]}},te=function(){function i(){}return i.addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},i.addMonths=function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,e.getDate())},i.addYears=function(e,t){return new Date(e.getFullYear()+t,e.getMonth(),e.getDate())},i.addHours=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t)},i.addMinutes=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()+t)},i.addSeconds=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t)},i.sameDate=function(e,t){return f(e)&&f(t)&&e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},i.sameTime=function(e,t){return f(e)&&f(t)&&e.getHours()==t.getHours()&&e.getMinutes()==t.getMinutes()&&e.getSeconds()==t.getSeconds()},i.equals=function(e,t){return f(e)&&f(t)&&e.getTime()==t.getTime()},i.fromDateTime=function(e,t){return e||t?(e||(e=t),t||(t=e),new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())):null},i.toFiscal=function(e,t){var n=ee.Globalize.calendar;return d(n.fiscalYearOffsets)?i.addMonths(e,-n.fiscalYearOffsets[t?0:1]):e},i.fromFiscal=function(e,t){var n=ee.Globalize.calendar;return d(n.fiscalYearOffsets)?i.addMonths(e,+n.fiscalYearOffsets[t?0:1]):e},i.clone=function(e){return i.fromDateTime(e,e)},i}(),ne=function(){function t(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.width=v(e),this.height=v(t)}return t.prototype.equals=function(e){return e instanceof t&&this.width==e.width&&this.height==e.height},t.prototype.clone=function(){return new t(this.width,this.height)},t}(),ie=function(){function O(){}return O.format=function(e,t,n,i){return t||(b(e)?t=e==Math.round(e)?"n0":"n2":f(e)&&(t="d")),b(e)?O.formatNumber(e,t,n,i):f(e)?O.formatDate(e,t):null!=e?e.toString():""},O.formatNumber=function(e,t,n,i){var r;v(e),B(t);var o=t?t.match(/([a-z])(\d*)(,*)(.*)/i):null,s=ee.Globalize.numberFormat,a=o?o[1].toLowerCase():"n",c=o&&o[2]?parseInt(o[2]):"c"==a?s.currency.decimals:e==Math.round(e)?0:2,l=o&&o[3]?3*o[3].length:0,u=o&&o[4]?o[4]:s.currency.symbol,h=s["."],p=s[","];if(l&&(e/=Math.pow(10,l)),"d"==a||"x"==a){for(r=Math.round(Math.abs(e)).toString("d"==a?10:16);r.length<c;)r="0"+r;return e<0&&(r="-"+r),t&&"X"==t[0]&&(r=r.toUpperCase()),r}if("p"==a&&(e*=100),i&&(e=function(e,t,n){if(n){var i=(r=e.toString()).indexOf(".");-1<i&&(r=r.substr(0,i+1+t),e=parseFloat(r))}else{var r=e.toFixed(t);e=parseFloat(r)}return e}(e,c,!0)),r="c"==a||"p"==a?Math.abs(e).toFixed(c):e.toFixed(c),(n||"g"==a)&&-1<r.indexOf(".")&&(r=(r=r.replace(/(\.[0-9]*?)0+$/g,"$1")).replace(/\.$/,"")),"."!=h&&(r=r.replace(".",h)),p&&("n"==a||"c"==a||"p"==a)){var d=r.indexOf(h),f=/\B(?=(\d\d\d)+(?!\d))/g;r=-1<d?r.substr(0,d).replace(f,p)+r.substr(d):r.replace(f,p)}"c"==a&&(r=s.currency.pattern[e<0?0:1].replace("n",r).replace("$",u));"p"==a&&(r=s.percent.pattern[e<0?0:1].replace("n",r));return r},O.formatDate=function(e,t){var n,i;switch(n=e,void 0===i&&(i=!1),m(i&&null==n||f(n),"Date expected."),e=n,t){case"r":case"R":return e.toUTCString();case"u":return e.toISOString().replace(/\.\d{3}/,"")}t=O._expandFormat(t);for(var r=O._parseDateFormat(t),o="",s=0;s<r.length;s++)o+=O._formatDatePart(e,t,r[s]);return o},O.parseInt=function(e,t){return Math.round(O.parseFloat(e,t))},O.parseFloat=function(e,t){var n=-1<e.indexOf("-")||-1<e.indexOf("(")&&-1<e.indexOf(")")?-1:1,i=-1<e.indexOf("%")?.01:1,r=t?t.match(/,+/):null,o=r?3*r[0].length:0;if(t&&("x"==t[0]||"X"==t[0]))return e=e.replace(/[^0-9a-f]+.*$/gi,""),parseInt(e,16)*n*i*Math.pow(10,o);var s=ee.Globalize.numberFormat["."],a=new RegExp("[^\\d\\"+s+"]","g");e=e.replace(a,"").replace(s,".");return parseFloat(e)*n*i*Math.pow(10,o)},O.parseDate=function(e,t){if(!(e=B(e)))return null;if("u"==t)return new Date(e);if("R"==t||"r"==t){var n=e.match(/(([0-9]+)\-([0-9]+)\-([0-9]+))?\s?(([0-9]+):([0-9]+)(:([0-9]+))?)?/);if(n[1]||n[5]){var i=n[1]?new Date(parseInt(n[2]),parseInt(n[3])-1,parseInt(n[4])):new Date;n[5]&&(i.setHours(parseInt(n[6])),i.setMinutes(parseInt(n[7])),i.setSeconds(n[8]?parseInt(n[9]):0))}else i=new Date(e);return isNaN(i.getTime())?null:i}t=O._expandFormat(t||"d");var r,o,s,a,c,l=ee.Globalize.calendar,u=O._CJK,h=new RegExp("(\\"+l["/"]+")|(\\"+l[":"]+")|(\\d+)|(["+u+"\\.]{2,})|(["+u+"]+)","gi"),p=e.match(h),d=O._parseDateFormat(t),f=0,g=-1,_=0,m=1,b=0,y=0,v=0,w=0,C=-1;if(!(p&&p.length&&d&&d.length))return null;for(var x=0;x<d.length&&p;x++){var I=x-f,D=-1<I&&I<p.length?p[I]:"",P=d[x].length;switch(d[x]){case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":c=d[x];case"yyyy":case"yyy":case"yy":case"y":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),g=parseInt(D);break;case"MMMM":case"MMM":a=!0;var E=D.toLowerCase();_=-1;for(var F=0;F<12;F++)if(0==l.months[F].toLowerCase().indexOf(E)){_=F;break}break;case"MM":case"M":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),_=parseInt(D)-1,a=!0;break;case"dddd":case"ddd":r=!0;break;case"dd":case"d":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),m=parseInt(D),o=!0;break;case"hh":case"h":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),b=12==(b=parseInt(D))?0:b;break;case"HH":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),b=parseInt(D);break;case"H":b=parseInt(D);break;case"mm":case"m":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),y=parseInt(D);break;case"ss":case"s":1<P&&D.length>P&&(p[I]=D.substr(P),D=D.substr(0,P),f++),v=parseInt(D);break;case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":w=parseInt(D)/Math.pow(10,P-3);break;case"tt":case"t":D=D.toUpperCase(),(l.pm[0]&&D==l.pm[0]&&b<12||l.pm[1]&&D==l.pm[1]&&b<12)&&(b+=12);break;case"q":case"Q":case"u":case"U":s=!0;break;case"ggg":case"gg":case"g":C=1<l.eras.length?O._getEra(D,l):-1;break;case l["/"]:case l[":"]:if(D&&D!=d[x])return null;break;case"K":break;default:O._unquote(d[x])!=D&&f++}}if(a&&o&&(isNaN(b)&&(b=0),isNaN(y)&&(y=0),isNaN(v)&&(v=0)),_<0||11<_||isNaN(_)||m<0||31<m||isNaN(m)||b<0||24<b||isNaN(b)||y<0||60<y||isNaN(y)||v<0||60<v||isNaN(v))return null;if(c){if(!a)return null;i=new Date(g,_),g=(i=te.fromFiscal(i,"E"==c[0])).getFullYear(),_=i.getMonth()}return r&&!o?null:s&&!a?null:(g<0&&(g=(new Date).getFullYear()),-1<C?g=g+l.eras[C].start.getFullYear()-1:g<100&&(g+=30<=g?1900:2e3),i=new Date(g,_,m,b,y+0,v,w),isNaN(i.getTime())?null:i)},O.getFirstDayOfWeek=function(){var e=ee.Globalize.calendar.firstDay;return e||0},O.getNumberDecimalSeparator=function(){var e=ee.Globalize.numberFormat["."];return e||"."},O._unquote=function(e){return 1<e.length&&e[0]==e[e.length-1]&&("'"==e[0]||'"'==e[0])?e.substr(1,e.length-2):e},O._parseDateFormat=function(e){if(e in O._dateFomatParts)return O._dateFomatParts[e];var t,n,i=[];for(t=0;-1<t&&t<e.length;t++){var r=e[t];if(("'"==r||'"'==r)&&-1<(n=e.indexOf(r,t+1)))i.push(e.substring(t,n+1)),t=n;else{for(n=t+1;n<e.length&&e[n]==r;n++);i.push(e.substring(t,n)),t=n-1}}return O._dateFomatParts[e]=i},O._formatDatePart=function(e,t,n){var i,r=ee.Globalize.calendar,o=0,s=0,a=0,c=n.length;switch(n){case"yyyy":case"yyy":case"yy":case"y":case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":return s=(i="E"==n[0]?te.toFiscal(e,!0):"e"==n[0]?te.toFiscal(e,!1):e).getFullYear(),1<r.eras.length&&-1<t.indexOf("g")&&-1<(o=O._getEra(e,r))&&(s=s-r.eras[o].start.getFullYear()+1),O._zeroPad(s,4).substr(4-n.length);case"MMMM":return r.months[e.getMonth()];case"MMM":return r.monthsAbbr[e.getMonth()];case"MM":case"M":return O._zeroPad(e.getMonth()+1,c);case"dddd":return r.days[e.getDay()];case"ddd":return r.daysAbbr[e.getDay()];case"dd":return O._zeroPad(e.getDate(),2);case"d":return e.getDate().toString();case"hh":case"h":return O._zeroPad(O._h12(e),c);case"HH":case"H":return O._zeroPad(e.getHours(),c);case"mm":case"m":return O._zeroPad(e.getMinutes(),c);case"ss":case"s":return O._zeroPad(e.getSeconds(),c);case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":return a=e.getMilliseconds()*Math.pow(10,c-3),"f"==n[0]?O._zeroPad(a,c):a.toFixed(0);case"tt":return e.getHours()<12?r.am[0]:r.pm[0];case"t":return e.getHours()<12?r.am[1]:r.pm[1];case"q":case"Q":return(Math.floor(e.getMonth()/3)+1).toString();case"u":case"U":return i=te.toFiscal(e,"U"==n),(Math.floor(i.getMonth()/3)+1).toString();case"ggg":case"gg":case"g":return 1<r.eras.length&&-1<(o=O._getEra(e,r))?"ggg"==n?r.eras[o].name:"gg"==n?r.eras[o].name[0]:r.eras[o].symbol:r.eras[0];case":":case"/":return r[n];case"K":var l=e.toString().match(/(\+|\-)(\d{2})(\d{2})/);return l?l[1]+l[2]+l[3]:""}return 1<c&&n[0]==n[c-1]&&('"'==n[0]||"'"==n[0])?n.substr(1,c-2):n},O._getEra=function(e,t){if(f(e)){for(var n=0;n<t.eras.length;n++)if(e>=t.eras[n].start)return n}else if(U(e))for(n=0;n<t.eras.length;n++)if(t.eras[n].name&&(0==t.eras[n].name.indexOf(e)||0==t.eras[n].symbol.indexOf(e)))return n;return-1},O._expandFormat=function(e){var t=ee.Globalize.calendar.patterns[e];return t||e},O._zeroPad=function(e,t){var n=e.toFixed(0),i=t-n.length+1;return 0<i?Array(i).join("0")+n:n},O._h12=function(e){var t=ee.Globalize.calendar,n=e.getHours();return t.am&&t.am[0]&&0==(n%=12)&&(n=12),n},O}();ie._CJK="a-zu00C0-u017Fu3000-u30ffu4e00-u9faf".replace(/u/g,"\\u"),ie._dateFomatParts={};var re=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._path},set:function(e){this._path=e,this._parts=e.split(".");for(var t=0;t<this._parts.length;t++){var n=this._parts[t],i=n.indexOf("[");-1<i&&(this._parts[t]=n.substr(0,i),this._parts.splice(++t,0,parseInt(n.substr(i+1))))}this._key=1==this._parts.length?this._parts[0]:null},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(e){if(this._key)return e[this._key];if(this._path in e)return e[this._path];for(var t=0;t<this._parts.length&&e;t++)e=e[this._parts[t]]}return e},e.prototype.setValue=function(e,t){if(e){if(this._path in e)return void(e[this._path]=t);for(var n=0;n<this._parts.length-1;n++)if(null==(e=e[this._parts[n]]))return;e[this._parts[this._parts.length-1]]=t}},e}(),oe=function(){function u(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var i=this;this._focus=!1,this._updating=0,this._fullUpdate=!1,this.gotFocus=new S,this.lostFocus=new S,m(null==u.getControl(e),"Element is already hosting a control.");var r=J(e);if(m(null!=r,"Cannot find the host element."),this._orgOuter=r.outerHTML,this._orgInner=r.innerHTML,"INPUT"!=r.tagName&&"SELECT"!=r.tagName||(this._orgAtts=r.attributes,this._orgTag=r.tagName,r=this._replaceWithDiv(r)),(this._e=r)[u._DATA_KEY]=this,1==n){this._szCtl=new ne(r.offsetWidth,r.offsetHeight);var o=this._handleResize.bind(this);this.addEventListener(window,"resize",o)}this.addEventListener(r,"focus",function(){i._updateFocusState()},!0),this.addEventListener(r,"blur",function(){i._updateFocusState()},!0);var s=this._handleDisabled.bind(this);if(this.addEventListener(r,"mousedown",s,!0),this.addEventListener(r,"mouseup",s,!0),this.addEventListener(r,"click",s,!0),this.addEventListener(r,"dblclick",s,!0),this.addEventListener(r,"keydown",s,!0),this.addEventListener(r,"onmousewheel"in document?"mousewheel":"DOMMouseScroll",s,!0),null==u._touching&&(u._touching=!1,"ontouchstart"in window||"onpointerdown"in window)){var a=document.body,c=this._handleTouchStart,l=this._handleTouchEnd;"ontouchstart"in window?(a.addEventListener("touchstart",c),a.addEventListener("touchend",l),a.addEventListener("touchcancel",l),a.addEventListener("touchleave",l)):"onpointerdown"in window&&(a.addEventListener("pointerdown",c),a.addEventListener("pointerup",l),a.addEventListener("pointerout",l),a.addEventListener("pointercancel",l),a.addEventListener("pointerleave",l))}}return u.prototype.getTemplate=function(){for(var e=Object.getPrototypeOf(this);e;e=Object.getPrototypeOf(e))return e.constructor.controlTemplate;return null},u.prototype.applyTemplate=function(e,t,n,i){var r=this._e;e&&K(r,e);var o,s,a=null;if(t&&(o=t,(s=document.createElement("div")).innerHTML=o,a=s.removeChild(s.firstChild),a=r.appendChild(a)),r&&!r.getAttribute("tabindex")&&(r.tabIndex=r.querySelector("input")?-1:0),n)for(var c in n){var l=n[c];if(this[c]=a.querySelector('[wj-part="'+l+'"]'),null==this[c]&&a.getAttribute("wj-part")==l&&(this[c]=a),null==this[c])throw'Missing template part: "'+l+'"';if(l==i){var u=r.attributes.name;u&&u.value&&this[c].setAttribute("name",u.value),(u=r.attributes.accesskey)&&u.value&&(this[c].setAttribute("accesskey",u.value),r.removeAttribute("accesskey"))}}return a},u.prototype.dispose=function(){for(var e=this._e.querySelectorAll(".wj-control"),t=0;t<e.length;t++){var n=u.getControl(e[t]);n&&n.dispose()}for(var i in this._toInv&&clearTimeout(this._toInv),this.removeEventListener(),this)if(2<i.length&&0==i.indexOf("on")){var r=this[i[2].toLowerCase()+i.substr(3)];r instanceof S&&r.removeAllHandlers()}this.collectionView;this._e.parentNode&&(this._e.outerHTML=this._orgOuter),this._e[u._DATA_KEY]=null,this._e=this._orgOuter=this._orgInner=this._orgAtts=this._orgTag=null},u.getControl=function(e){var t=J(e);return t?q(t[u._DATA_KEY],u,!0):null},Object.defineProperty(u.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),u.prototype.focus=function(){this._e.focus()},u.prototype.containsFocus=function(){if(!this._e)return!1;for(var e=this._e.getElementsByClassName("wj-control"),t=0;t<e.length;t++){var n=u.getControl(e[t]);if(n&&n!=this&&n.containsFocus())return!0}return W(this._e,document.activeElement)},u.prototype.invalidate=function(e){var t=this;void 0===e&&(e=!0),this._fullUpdate=this._fullUpdate||e,this._toInv&&(clearTimeout(this._toInv),this._toInv=null),this.isUpdating||(this._toInv=window.setTimeout(function(){t.refresh(t._fullUpdate)},u._REFRESH_INTERVAL))},u.prototype.refresh=function(e){void 0===e&&(e=!0),!this.isUpdating&&this._toInv&&(clearTimeout(this._toInv),this._toInv=null,this._fullUpdate=!1)},u.invalidateAll=function(e){e||(e=document.body);var t=u.getControl(e);if(t&&t.invalidate(),e.children)for(var n=0;n<e.children.length;n++)u.invalidateAll(e.children[n])},u.refreshAll=function(e){e||(e=document.body);var t=u.getControl(e);if(t&&t.refresh(),e.children)for(var n=0;n<e.children.length;n++)u.refreshAll(e.children[n])},u.disposeAll=function(e){var t=u.getControl(e);if(t)t.dispose();else if(e.children)for(var n=0;n<e.children.length;n++)u.disposeAll(e.children[n])},u.prototype.beginUpdate=function(){this._updating++},u.prototype.endUpdate=function(){this._updating--,this._updating<=0&&this.invalidate()},Object.defineProperty(u.prototype,"isUpdating",{get:function(){return 0<this._updating},enumerable:!0,configurable:!0}),u.prototype.deferUpdate=function(e){try{this.beginUpdate(),e()}finally{this.endUpdate()}},Object.defineProperty(u.prototype,"isTouching",{get:function(){return u._touching},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"disabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(e){var t,n;(e=x(e,!0))!=this.disabled&&(t=this._e,(n=!e)?t.removeAttribute("disabled"):t.setAttribute("disabled","true"),$(t,"wj-state-disabled",!n))},enumerable:!0,configurable:!0}),u.prototype.initialize=function(t){t&&(this.beginUpdate(),function e(t,n){for(var i in n){m(i in t,'Unknown key "'+i+'".');var r=n[i];t._copy&&t._copy(i,r)||(t[i]instanceof Event&&_(r)?t[i].addHandler(r):g(r)&&t[i]?e(t[i],r):t[i]=r)}}(this,t),this.endUpdate())},u.prototype.addEventListener=function(e,t,n,i){void 0===i&&(i=!1),e&&(e.addEventListener(t,n,i),null==this._listeners&&(this._listeners=[]),this._listeners.push({target:e,type:t,fn:n,capture:i}))},u.prototype.removeEventListener=function(e,t,n){if(this._listeners)for(var i=0;i<this._listeners.length;i++){var r=this._listeners[i];null!=e&&e!=r.target||null!=t&&t!=r.type||null!=n&&n!=r.capture||(r.target.removeEventListener(r.type,r.fn,r.capture),this._listeners.splice(i,1),i--)}},u.prototype.onGotFocus=function(e){this.gotFocus.raise(this,e)},u.prototype.onLostFocus=function(e){this.lostFocus.raise(this,e)},u.prototype._handleResize=function(){if(this._e.parentElement){var e=new ne(this._e.offsetWidth,this._e.offsetHeight);e.equals(this._szCtl)||(this._szCtl=e,this.invalidate())}},u.prototype._updateFocusState=function(){var i=this;setTimeout(function(){var e=i.containsFocus();if(e!=i._focus&&((i._focus=e)?i.onGotFocus():i.onLostFocus(),$(i._e,"wj-state-focused",e)),i._e)for(var t=i._e.parentElement;t;t=t.parentElement){var n=u.getControl(t);if(n){n._updateFocusState();break}}})},u.prototype._handleTouchStart=function(e){null!=e.pointerType&&"touch"!=e.pointerType||(u._touching=!0,console.log("touching = true"))},u.prototype._handleTouchEnd=function(e){null!=e.pointerType&&"touch"!=e.pointerType||setTimeout(function(){u._touching=!1,console.log("touching = false")},400)},u.prototype._handleDisabled=function(e){this.disabled&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())},u.prototype._replaceWithDiv=function(e){var t=e.parentElement,n=document.createElement("div");t.replaceChild(n,e),n.innerHTML=e.innerHTML;for(var i=e.attributes,r=0;r<i.length;r++){var o=i[r].name;"id"!=o&&"style"!=o||n.setAttribute(o,i[r].value)}return n},u.prototype._copyOriginalAttributes=function(e){var t=this._orgAtts;if(t)for(var n=0;n<t.length;n++){var i=t[n].name.toLowerCase();"id"!=i&&"style"!=i&&"type"!=i&&e.setAttribute(i,t[n].value)}},u}();oe._DATA_KEY="wj-Control",oe._REFRESH_INTERVAL=10;var se={Back:8,Tab:9,Enter:13,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};se[se.Back]="Back",se[se.Tab]="Tab",se[se.Enter]="Enter",se[se.Escape]="Escape",se[se.Space]="Space",se[se.PageUp]="PageUp",se[se.PageDown]="PageDown",se[se.End]="End",se[se.Home]="Home",se[se.Left]="Left",se[se.Up]="Up",se[se.Right]="Right",se[se.Down]="Down",se[se.Delete]="Delete",se[se.F1]="F1",se[se.F2]="F2",se[se.F3]="F3",se[se.F4]="F4",se[se.F5]="F5",se[se.F6]="F6",se[se.F7]="F7",se[se.F8]="F8",se[se.F9]="F9",se[se.F10]="F10",se[se.F11]="F11",se[se.F12]="F12";var ae=function(o){function e(e,t){var n=o.call(this,e,null,!0)||this;n._showBtn=!0,n._autoExpand=!0,n.textChanged=new S,n.isDroppedDownChanging=new S,n.isDroppedDownChanged=new S;var i=n.getTemplate();n.applyTemplate("wj-control wj-dropdown wj-content",i,{_tbx:"input",_btn:"btn",_dropDown:"dropdown"},"input"),n._elRef=n._tbx,n._tbx.autocomplete="off",n._createDropDown(),n._updateBtn(),n.addEventListener(n._dropDown,"blur",function(){n._updateFocusState()},!0);var r=n._keydown.bind(n);return n.addEventListener(n.hostElement,"keydown",r),n.addEventListener(n.dropDown,"keydown",r),n.addEventListener(n._tbx,"input",function(){n._setText(n.text,!1)}),n.addEventListener(n._tbx,"click",function(){n._autoExpand&&n._expandSelection()}),n.addEventListener(n.dropDown,"focus",function(){n._updateFocusState()}),document.doctype&&-1<navigator.appVersion.indexOf("MSIE 9")&&n.addEventListener(n._tbx,"keyup",function(){n._setText(n.text,!1)}),n.addEventListener(n._btn,"click",n._btnclick.bind(n)),n.addEventListener(n._dropDown,"click",function(e){e.stopPropagation()}),"INPUT"==n._orgTag&&n._copyOriginalAttributes(n._tbx),n}return c(e,o),Object.defineProperty(e.prototype,"text",{get:function(){return this._tbx.value},set:function(e){e!=this.text&&this._setText(e,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDroppedDown",{get:function(){return"none"!=this._dropDown.style.display},set:function(e){if(e=x(e)&&!this.disabled,console.log("is_dropped_down"),e!=this.isDroppedDown&&this.onIsDroppedDownChanging(new j)){var t=this._dropDown;e?(t.style.minWidth||(t.style.minWidth=this.hostElement.getBoundingClientRect().width+"px"),console.log("dropped_down_setting_block"),t.style.display="block",this._updateDropDown()):(this.containsFocus()&&(this.isTouching&&this.showDropDownButton||this.selectAll()),console.log("dropped_down_setting_none"),t.style.display="none"),this._updateFocusState(),this.onIsDroppedDownChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropDown",{get:function(){return this._dropDown},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDropDownButton",{get:function(){return this._showBtn},set:function(e){this._showBtn=x(e),this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoExpandSelection",{get:function(){return this._autoExpand},set:function(e){this._autoExpand=x(e)},enumerable:!0,configurable:!0}),e.prototype.selectAll=function(){this._elRef==this._tbx&&F(this._tbx,0,this.text.length)},e.prototype.onTextChanged=function(e){this.textChanged.raise(this,e)},e.prototype.onIsDroppedDownChanging=function(e){return this.isDroppedDownChanging.raise(this,e),!e.cancel},e.prototype.onIsDroppedDownChanged=function(e){this.isDroppedDownChanged.raise(this,e)},e.prototype.onGotFocus=function(e){this.isTouching||this.selectAll(),o.prototype.onGotFocus.call(this,e)},e.prototype.onLostFocus=function(e){this._commitText(),this.containsFocus()||(this.isDroppedDown=!1),o.prototype.onLostFocus.call(this,e)},e.prototype.containsFocus=function(){return o.prototype.containsFocus.call(this)||W(this._dropDown,document.activeElement)},e.prototype.dispose=function(){this.isDroppedDown=!1,o.prototype.dispose.call(this)},e.prototype.refresh=function(e){if(void 0===e&&(e=!0),o.prototype.refresh.call(this,e),this.isDroppedDown&&"none"!=getComputedStyle(this.hostElement).display){var t=document.activeElement;t instanceof HTMLElement&&t!=document.activeElement&&t.focus()}},e.prototype._handleResize=function(){this.isDroppedDown&&this.refresh()},e.prototype._expandSelection=function(){var e=this._tbx,t=e.value,n=e.selectionStart,i=e.selectionEnd;if(t&&n==i){var r=this._getCharType(t,n);if(-1<r){for(;i<t.length&&this._getCharType(t,i)==r;i++);for(;0<n&&this._getCharType(t,n-1)==r;n--);n!=i&&e.setSelectionRange(n,i)}}},e.prototype._getCharType=function(e,t){var n=e[t];return"0"<=n&&n<="9"?0:"a"<=n&&n<="z"||"A"<=n&&n<="Z"?1:-1},e.prototype._keydown=function(e){if(!e.defaultPrevented)switch(e.keyCode){case se.Tab:case se.Escape:case se.Enter:this.isDroppedDown=!1;break;case se.F4:case se.Down:case se.Up:(e.keyCode==se.F4||e.altKey)&&(this.isDroppedDown=!this.isDroppedDown,this.isDroppedDown||this._tbx.focus(),e.preventDefault())}},e.prototype._btnclick=function(e){this.isDroppedDown=!this.isDroppedDown},e.prototype._setText=function(e,t){null==e&&(e=""),(e=e.toString())!=this._tbx.value&&(this._tbx.value=e),e!=this._oldText&&(this._oldText=e,this.onTextChanged())},e.prototype._updateBtn=function(){this._btn.tabIndex=-1,this._btn.style.display=this._showBtn?"":"none"},e.prototype._createDropDown=function(){},e.prototype._commitText=function(){},e.prototype._updateDropDown=function(){this.isDroppedDown?(this._commitText(),console.log("dropped_down_1")):console.log("dropped_down_2")},e}(oe);ae.controlTemplate='<div style="position:relative" class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control" /><span wj-part="btn" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" type="button" tabindex="-1"><span class="wj-glyph-down"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel" style="display:none;position:absolute;z-index:100;width:auto"></div></div>';var ce=function(r){function e(e,t,n){var i=r.call(this)||this;return i._index=v(e),i._data=t,i._item=q(n,HTMLElement),i}return c(e,r),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),e}(M),le=function(r){function e(e,t){var n=r.call(this,e)||this;n._html=!1,n._search="",n.subscription1=new s.Subscription,n.subscription2=new s.Subscription,n.selectedIndexChanged=new S,n.itemsChanged=new S,n.loadingItems=new S,n.loadedItems=new S,n.itemChecked=new S,n.checkedItemsChanged=new S,n.formatItem=new S,n.applyTemplate("wj-control wj-listbox wj-content",null,null),"SELECT"==n._orgTag&&(n._copyOriginalAttributes(n.hostElement),n._populateSelectElement(n.hostElement));var i=n.hostElement;return n.addEventListener(i,"click",n._click.bind(n)),n.addEventListener(i,"keydown",n._keydown.bind(n)),n.addEventListener(i,"keypress",n._keypress.bind(n)),n.addEventListener(i,"onmousewheel"in document?"mousewheel":"DOMMouseScroll",function(e){i.scrollHeight>i.clientHeight&&(0<e.wheelDelta&&0==i.scrollTop||e.wheelDelta<0&&i.scrollTop+i.clientHeight>=i.scrollHeight)&&(e.preventDefault(),e.stopPropagation())}),n.initialize(t),n}return c(e,r),e.prototype.refresh=function(){r.prototype.refresh.call(this),this._populateList()},Object.defineProperty(e.prototype,"itemsSource",{get:function(){return this._items},set:function(e){var t=this;this._items!=e&&(this._cv&&(this.subscription1.unsubscribe(),this.subscription2.unsubscribe(),this._cv=null),this._items=e,this._cv=function(e,t){if(void 0===t&&(t=!0),null==e&&t)return null;var n=P(e,"ICollectionView");return null!=n?n:(d(e)||m(!1,"Array or ICollectionView expected."),new G(e))}(e),null!=this._cv&&(this.subscription1=this._cv.currentChanged.subscribe(function(e){return t._cvCurrentChanged(t,e)}),this.subscription2=this._cv.collectionChanged.subscribe(function(e){return t._cvCollectionChanged(t,e)})),this._populateList(),this.onItemsChanged(),this.onSelectedIndexChanged())},enumerable:!0,configurable:!0}),e.prototype.removeAt=function(e){P(this._cv,"IEditableCollectionView").removeAt(e)},Object.defineProperty(e.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){e!=this._html&&(this._html=x(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){e!=this._itemFormatter&&(this._itemFormatter=y(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMemberPath",{get:function(){return this._pathDisplay},set:function(e){e!=this._pathDisplay&&(this._pathDisplay=B(e),this._populateList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValuePath",{get:function(){return this._pathValue},set:function(e){this._pathValue=B(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checkedMemberPath",{get:function(){return this._pathChecked},set:function(e){e!=this._pathChecked&&(this._pathChecked=B(e),this._populateList())},enumerable:!0,configurable:!0}),e.prototype.getDisplayValue=function(e){var t=null;-1<e&&E(this._cv)&&(t=this._cv.items[e],this.displayMemberPath&&(t=t[this.displayMemberPath]));var n=null!=t?t.toString():"";return this.itemFormatter&&(n=this.itemFormatter(e,n)),n},e.prototype.getDisplayText=function(e){var t=this.hostElement.children,n=-1<e&&e<t.length?t[e]:null;return null!=n?n.textContent:""},Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._cv?this._cv.currentPosition:-1},set:function(e){this._cv&&this._cv.moveCurrentToPosition(v(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._cv?this._cv.currentItem:null},set:function(e){this._cv&&this._cv.moveCurrentTo(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValue",{get:function(){var e=this.selectedItem;return e&&this.selectedValuePath&&(e=e[this.selectedValuePath]),e},set:function(e){var t=this.selectedValuePath,n=-1;if(this._cv){for(var i=0;i<this._cv.items.length;i++){var r=this._cv.items[i];if(t&&r[t]==e||!t&&r==e){n=i;break}}this.selectedIndex=n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){var e=this.hostElement;return e?parseFloat(e.style.maxHeight):null},set:function(e){var t=this.hostElement;t&&(t.style.maxHeight=v(e)+"px")},enumerable:!0,configurable:!0}),e.prototype.showSelection=function(){for(var e,t=this.selectedIndex,n=this.hostElement,i=n.children,r=0;r<i.length;r++)$(e=i[r],"wj-state-selected",r==t);if(-1<t&&t<i.length){var o=(e=i[t]).getBoundingClientRect(),s=this.hostElement.getBoundingClientRect();o.bottom>s.bottom?n.scrollTop+=o.bottom-s.bottom:o.top<s.top&&(n.scrollTop-=s.top-o.top)}-1<t&&this.containsFocus()&&(e=i[t])instanceof HTMLElement&&!W(e,document.activeElement)&&e.focus()},e.prototype.getItemChecked=function(e){var t=this._cv.items[e];if(g(t)&&this.checkedMemberPath)return t[this.checkedMemberPath];var n=this._getCheckbox(e);return!!n&&n.checked},e.prototype.setItemChecked=function(e,t){this._setItemChecked(e,t,!0)},e.prototype.toggleItemChecked=function(e){this.setItemChecked(e,!this.getItemChecked(e))},Object.defineProperty(e.prototype,"checkedItems",{get:function(){var e=[];if(this._cv)for(var t=0;t<this._cv.items.length;t++)this.getItemChecked(t)&&e.push(this._cv.items[t]);return e},set:function(e){var t=this._cv,n=w(e,!1);if(t&&n){for(var i=t.currentPosition,r=0;r<t.items.length;r++){var o=t.items[r];this._setItemChecked(r,-1<n.indexOf(o),!1)}t.moveCurrentToPosition(i),this.onCheckedItemsChanged()}},enumerable:!0,configurable:!0}),e.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)},e.prototype.onItemsChanged=function(e){this.itemsChanged.raise(this,e)},e.prototype.onLoadingItems=function(e){this.loadingItems.raise(this,e)},e.prototype.onLoadedItems=function(e){this.loadedItems.raise(this,e)},e.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)},e.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)},e.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},e.prototype._setItemChecked=function(e,t,n){void 0===n&&(n=!0);var i=this._cv.items[e];if(g(i)){var r=P(this._cv,"IEditableCollectionView");i[this.checkedMemberPath]!=t&&(this._checking=!0,r?(r.editItem(i),i[this.checkedMemberPath]=t,r.commitEdit()):(i[this.checkedMemberPath]=t,this._cv.refresh()),this._checking=!1)}var o=this._getCheckbox(e);o&&o.checked!=t&&(o.checked=t),n&&(this.onItemChecked(),this.onCheckedItemsChanged())},e.prototype._cvCollectionChanged=function(e,t){console.log("list_box_collection_view_changed_start"),1!=t.action?this._checking||(this._populateList(),this.onItemsChanged()):console.log("list_box_collection_view_changed_is_remove")},e.prototype._cvCurrentChanged=function(e,t){console.log("cv_current_changed"),this.showSelection(),this.onSelectedIndexChanged()},e.prototype._populateList=function(){console.log("list_box_populate_list_start");var e,t=this.hostElement;if(t){var n=this.containsFocus();if(this.onLoadingItems(),t.innerHTML="",this._cv)for(var i=0;i<this._cv.items.length;i++){console.log("list_box_populate_list:"+i);var r=this.getDisplayValue(i);if(1!=this._html&&(U(e=r)&&(e=e.replace(/[&<>"'\/]/g,function(e){return Z[e]})),r=e),this.checkedMemberPath)r='<label><input type="checkbox"'+(this._cv.items[i][this.checkedMemberPath]?" checked":"")+"> "+r+"</label>";var o=document.createElement("div");if(o.innerHTML=r,o.className="wj-listbox-item",Y(o.firstChild,"wj-separator")&&(o.className+=" wj-separator"),this.formatItem.hasHandlers){var s=new ce(i,this._cv.items[i],o);this.onFormatItem(s)}t.appendChild(o)}0==t.children.length&&t.appendChild(document.createElement("div")),n&&!this.containsFocus()&&this.focus(),this.showSelection(),this.onLoadedItems()}console.log("list_box_populate_list_finish")},e.prototype._click=function(e){for(var t=this.hostElement.children,n=0;n<t.length;n++)if(W(t[n],e.target)){this.selectedIndex=n,this.removeAt(n),this._cv.refresh();break}if(this.checkedMemberPath&&-1<this.selectedIndex){var i=this._getCheckbox(this.selectedIndex);i==e.target&&this.setItemChecked(this.selectedIndex,i.checked)}},e.prototype._keydown=function(e){if(!e.defaultPrevented&&!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){var t=this.selectedIndex,n=this.hostElement,i=n.children;switch(e.keyCode){case se.Down:e.preventDefault(),t<i.length-1&&this.selectedIndex++;break;case se.Up:e.preventDefault(),0<t&&this.selectedIndex--;break;case se.Home:e.preventDefault(),this.selectedIndex=0;break;case se.End:e.preventDefault(),this.selectedIndex=i.length-1;break;case se.PageDown:if(e.preventDefault(),-1<this.selectedIndex){t=this.selectedIndex;for(var r=n.offsetHeight,o=0,s=t+1;s<this._cv.items.length;s++){if(r<o+(a=i[s].scrollHeight)){this.selectedIndex=s;break}o+=a}this.selectedIndex==t&&this._cv.moveCurrentToLast()}break;case se.PageUp:if(e.preventDefault(),-1<this.selectedIndex){for(t=this.selectedIndex,r=n.offsetHeight,o=0,s=t-1;0<s;s--){var a;if(r<o+(a=i[s].scrollHeight)){this.selectedIndex=s;break}o+=a}this.selectedIndex==t&&this._cv.moveCurrentToFirst()}break;case se.Space:if(this.checkedMemberPath&&-1<this.selectedIndex){var c=this._getCheckbox(this.selectedIndex);c&&(this.hostElement.focus(),this.setItemChecked(this.selectedIndex,!c.checked),e.preventDefault())}}}},e.prototype._keypress=function(e){var t=this;if(!e.defaultPrevented&&!(e.target instanceof HTMLInputElement)&&(32<e.charCode||32==e.charCode&&this._search)&&(e.preventDefault(),this._search+=String.fromCharCode(e.charCode).toLowerCase(),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=window.setTimeout(function(){t._toSearch=0,t._search=""},600),this.hostElement))for(var n=this.hostElement.childElementCount,i=1<this._search.length?0:1;i<n;i++){var r=(this.selectedIndex+i)%n;if(0==this.getDisplayText(r).trim().toLowerCase().indexOf(this._search)){this.selectedIndex=r;break}}},e.prototype._getCheckbox=function(e){return this.hostElement?this.hostElement.children[e].querySelector("input[type=checkbox]"):null},e.prototype._populateSelectElement=function(e){for(var t=e.children,n=[],i=-1,r=0;r<t.length;r++){var o=t[r];"OPTION"==o.tagName&&(o.hasAttribute("selected")&&(i=n.length),o.innerHTML?n.push({hdr:o.innerHTML,val:o.getAttribute("value"),cmdParam:o.getAttribute("cmd-param")}):n.push({hdr:'<div class="wj-separator"/>'}),e.removeChild(o),r--)}n&&(this.displayMemberPath="hdr",this.selectedValuePath="val",this.itemsSource=n,this.selectedIndex=i)},e}(oe),ue=function(a){function e(e,t){var n=a.call(this,e)||this;n._required=!0,n._editable=!1,n._composing=!1,n._deleting=!1,n._settingText=!1,n.selectedIndexChanged=new S,n.autoExpandSelection=!1,n.addEventListener(n._tbx,"compositionstart",function(){n._composing=!0}),n.addEventListener(n._tbx,"compositionend",function(){n._composing=!1,n._setText(n.text,!0)});var i="onmousewheel"in document?"mousewheel":"DOMMouseScroll";return n.addEventListener(n.hostElement,i,function(e){if(n.containsFocus()&&!n.isDroppedDown&&!e.defaultPrevented&&-1<n.selectedIndex){var t=X(e.wheelDelta||-e.detail,-1,1);n.selectedIndex=X(n.selectedIndex-t,0,n.collectionView.items.length-1),e.preventDefault()}}),"SELECT"==n._orgTag&&(n._copyOriginalAttributes(n.hostElement),n._lbx._populateSelectElement(n.hostElement)),n.initialize(t),n}return c(e,a),Object.defineProperty(e.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){this._lbx.itemsSource=e,this._updateBtn()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e;var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerPath",{get:function(){return this._hdrPath},set:function(e){this._hdrPath=B(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValuePath",{get:function(){return this._lbx.selectedValuePath},set:function(e){this._lbx.selectedValuePath=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){if(e!=this.isContentHtml){this._lbx.isContentHtml=x(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._lbx.itemFormatter},set:function(e){this._lbx.itemFormatter=y(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){e!=this.selectedIndex&&(this._lbx.selectedIndex=e);var t=this.getDisplayText(e);this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._lbx.selectedItem},set:function(e){this._lbx.selectedItem=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedValue",{get:function(){return this._lbx.selectedValue},set:function(e){this._lbx.selectedValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(e){this._required=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditable",{get:function(){return this._editable},set:function(e){this._editable=x(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDropDownHeight",{get:function(){return this._lbx.maxHeight},set:function(e){this._lbx.maxHeight=v(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDropDownWidth",{get:function(){var e=this._dropDown;return parseInt(e.style.maxWidth)},set:function(e){this._dropDown.style.maxWidth=v(e)+"px"},enumerable:!0,configurable:!0}),e.prototype.getDisplayText=function(e){if(void 0===e&&(e=this.selectedIndex),this.headerPath&&-1<e&&E(this.collectionView)){var t=this.collectionView.items[e][this.headerPath],n=null!=t?t.toString():"";return this.isContentHtml&&(this._cvt||(this._cvt=document.createElement("div")),this._cvt.innerHTML=n,n=this._cvt.textContent),n}return this._lbx.getDisplayText(e)},e.prototype.onSelectedIndexChanged=function(e){this._updateBtn(),this.selectedIndexChanged.raise(this,e),console.log("droppped_down_setting_to_false")},e.prototype.indexOf=function(e,t){var n=this.collectionView;if(E(n)&&e){e=e.toString().toLowerCase();for(var i=0;i<n.items.length;i++){var r=this.getDisplayText(i).toLowerCase();if(t){if(r==e)return i}else if(0==r.indexOf(e))return i}}return-1},Object.defineProperty(e.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0}),e.prototype.onLostFocus=function(e){this.isEditable&&this.required&&!this.text&&E(this.collectionView)&&(this.selectedIndex=0),a.prototype.onLostFocus.call(this,e)},e.prototype.onIsDroppedDownChanging=function(e){console.log("combo_box_dropped_down_changing:"+e);var t=!!E(this.collectionView)&&a.prototype.onIsDroppedDownChanging.call(this,e);return 0==E(this.collectionView)&&(console.log("combo_box_dropped_down_changing_is_empty"),t=!0),console.log("combo_box_dropped_down:"+t),t},e.prototype.onIsDroppedDownChanged=function(e){a.prototype.onIsDroppedDownChanged.call(this,e),console.log("combo_box_dropped_down_changed"),this.isDroppedDown&&(this._lbx.showSelection(),this.isTouching||this.selectAll())},e.prototype._updateBtn=function(){var e=this.collectionView;console.log("combo_box_update_btn"),console.log("combo_box_update_btn:"+E(e)),console.log("combo_box_update_btn:"+this._showBtn),this._btn.style.display=this._showBtn&&E(e)?"":"none",console.log("combo_box_update_btn_display:"+this._btn.style.display)},e.prototype._createDropDown=function(){var t=this;this._lbx=new le(this._dropDown),this._lbx.maxHeight=200,this._lbx.selectedIndexChanged.addHandler(function(){t._updateBtn(),t.selectedIndex=t._lbx.selectedIndex,t.onSelectedIndexChanged()}),this._lbx.itemsChanged.addHandler(function(){t._updateBtn()}),this.addEventListener(this._dropDown,"click",function(e){e.target!=t._dropDown&&(t.isDroppedDown=!1)})},e.prototype._setText=function(e,t){if(!this._composing&&!this._settingText){this._settingText=!0,null==e&&(e=""),e=e.toString();var n=this.selectedIndex,i=this.collectionView,r=this._getSelStart(),o=-1;if(this._deleting&&(t=!0),this._deleting?n=this.indexOf(e,!0):((n=this.indexOf(e,t))<0&&t&&(n=this.indexOf(e,!1)),n<0&&0<r&&(n=this.indexOf(e.substr(0,r),!1))),n<0&&!this.isEditable&&E(i)&&this._oldText&&(this.required||e)){n=Math.max(0,this.indexOf(this._oldText,!1));for(var s=0;s<e.length&&s<this._oldText.length;s++)if(e[s]!=this._oldText[s]){r=s;break}}-1<n&&(o=r,e=this.getDisplayText(n)),i&&i.moveCurrentToPosition(n),e!=this._tbx.value&&(this._tbx.value=e),-1<o&&this.containsFocus()&&!this.isTouching&&this._setSelectionRange(o,e.length),a.prototype._setText.call(this,e,t),this._deleting=!1,this._settingText=!1}},e.prototype._findNext=function(e,t){if(this.collectionView){e=e.toLowerCase();for(var n=this.collectionView.items.length,i=void 0,r=1;r<=n;r++)if(i=(this.selectedIndex+r*t+n)%n,0==this.getDisplayText(i).toLowerCase().indexOf(e))return i}return this.selectedIndex},e.prototype._keydown=function(e){if(a.prototype._keydown.call(this,e),!e.defaultPrevented&&this._elRef==this._tbx){e.keyCode!=se.Back&&e.keyCode!=se.Delete||(this._deleting=!0);var t=this.collectionView;if(t&&t.items){var n=-1;switch(e.keyCode){case se.Up:n=this._getSelStart(),this.selectedIndex=this._findNext(this.text.substr(0,n),-1),this._setSelectionRange(n,this.text.length),e.preventDefault();break;case se.Down:n=this._getSelStart(),this.selectedIndex=this._findNext(this.text.substr(0,n),1),this._setSelectionRange(n,this.text.length),e.preventDefault()}}}},e.prototype._setSelectionRange=function(e,t){this._elRef==this._tbx&&F(this._tbx,e,t)},e.prototype._getSelStart=function(){return this._tbx&&this._tbx.value?this._tbx.selectionStart:0},e}(ae);e.DropDown=ae,e.ComboBox=ue,e.ClarityModule=p,e.ɵa=h,e.ɵb=oe,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ui-components-light.umd.min.js.map
